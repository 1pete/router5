!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.reduxRouter5={})}(this,function(t){"use strict";var e="@@router5/NAVIGATE",n="@@router5/CANCEL",r="@@router5/TRANSITION_ERROR",o="@@router5/TRANSITION_SUCCESS",u="@@router5/TRANSITION_START",a="@@router5/CLEAR_ERRORS",i="@@router5/CAN_DEACTIVATE",c="@@router5/CAN_ACTIVATE",s=Object.freeze({NAVIGATE_TO:e,CANCEL_TRANSITION:n,TRANSITION_ERROR:r,TRANSITION_SUCCESS:o,TRANSITION_START:u,CLEAR_ERRORS:a,CAN_DEACTIVATE:i,CAN_ACTIVATE:c});function l(t,e){return{type:u,payload:{route:t,previousRoute:e}}}function p(t,e){return{type:o,payload:{route:t,previousRoute:e}}}function f(t,e,n){return{type:r,payload:{route:t,previousRoute:e,transitionError:n}}}var y=Object.freeze({navigateTo:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:e,payload:{name:t,params:n,opts:r}}},cancelTransition:function(){return{type:n}},clearErrors:function(){return{type:a}},transitionStart:l,transitionSuccess:p,transitionError:f,canActivate:function(t,e){return{type:c,payload:{name:t,canActivate:e}}},canDeactivate:function(t,e){return{type:i,payload:{name:t,canDeactivate:e}}}});function d(t){function e(){return{onTransitionStart:function(e,n){t(l(e,n))},onTransitionSuccess:function(e,n){t(p(e,n))},onTransitionError:function(e,n,r){t(f(e,n,r))}}}return e.pluginName="REDUX_PLUGIN",e}var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m={route:null,previousRoute:null,transitionRoute:null,transitionError:null};var T="function"==typeof Symbol&&"symbol"===v(Symbol.iterator)?function(t){return void 0===t?"undefined":v(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":v(t)};function A(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])}function S(t){return t&&t.meta&&t.meta.params}function E(t,e){return void 0===(n=e.meta.params[t])||null===n?{}:Object.keys(e.meta.params[t]).reduce(function(t,n){return t[n]=e.params[n],t},{});var n}t.router5Middleware=function(t){return function(r){var o=r.dispatch;return t.setDependency("store",r),t.usePlugin(d(o)),function(r){return function(o){switch(o.type){case e:t.navigate(o.payload.name,o.payload.params,o.payload.opts);break;case n:t.cancel();break;case i:t.canDeactivate(o.payload.name,o.payload.canDeactivate);break;case c:t.canActivate(o.payload.name,o.payload.canDeactivate);break;default:return r(o)}}}}},t.router5Reducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments[1];switch(e.type){case u:return R({},t,{transitionRoute:e.payload.route,transitionError:null});case o:return R({},t,{transitionRoute:null,transitionError:null,previousRoute:e.payload.previousRoute,route:e.payload.route});case r:return R({},t,{transitionRoute:e.payload.route,transitionError:e.payload.transitionError});case a:return R({},t,{transitionRoute:null,transitionError:null});default:return t}},t.actions=y,t.actionTypes=s,t.routeNodeSelector=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"router",n=void 0;return function(r){var o=function(t){return t[e]||t.get&&t.get(e)}(r),u=o.route,a=o.previousRoute,i=u?function(t,e){var n=e?A(e.name):[],r=A(t.name),o=Math.min(n.length,r.length),u=void 0;u=e&&(S(e)||S(t))?function(){var u=void 0,a=function(){var o=n[u],a=r[u];if(o!==a)return{v:u};var i=E(o,t),c=E(a,e);return i.length!==c.length?{v:u}:0===i.length?"continue":Object.keys(i).some(function(t){return c[t]!==i[t]})?{v:u}:void 0};for(u=0;u<o;u+=1){var i=a();switch(i){case"continue":continue;default:if("object"===(void 0===i?"undefined":T(i)))return i.v}}return u}():0;var a=n.slice(u).reverse(),i=r.slice(u);return{intersection:e&&u>0?n[u-1]:"",toDeactivate:a,toActivate:i}}(u,a).intersection:"";return n?(!a||a!==u&&i===t)&&(n={route:u,previousRoute:a}):n={route:u,previousRoute:a},n}},t.reduxPlugin=d,Object.defineProperty(t,"__esModule",{value:!0})});
