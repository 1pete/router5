!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.reduxRouter5=t.reduxRouter5||{})}(this,function(t){"use strict";function e(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:T,payload:{name:t,params:e,opts:n}}}function n(){return{type:m}}function r(){return{type:N}}function o(t,e){return{type:S,payload:{route:t,previousRoute:e}}}function a(t,e){return{type:E,payload:{route:t,previousRoute:e}}}function u(t,e,n){return{type:A,payload:{route:t,previousRoute:e,transitionError:n}}}function i(t,e){return{type:I,payload:{name:t,canActivate:e}}}function c(t,e){return{type:g,payload:{name:t,canDeactivate:e}}}function s(t){function e(){return{onTransitionStart:function(e,n){t(o(e,n))},onTransitionSuccess:function(e,n){t(a(e,n))},onTransitionError:function(e,n,r){t(u(e,n,r))}}}return e.pluginName="REDUX_PLUGIN",e}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,e=arguments[1];switch(e.type){case S:return _({},t,{transitionRoute:e.payload.route,transitionError:null});case E:return _({},t,{transitionRoute:null,transitionError:null,previousRoute:e.payload.previousRoute,route:e.payload.route});case A:return _({},t,{transitionRoute:e.payload.route,transitionError:e.payload.transitionError});case N:return _({},t,{transitionRoute:null,transitionError:null});default:return t}}function p(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])}function f(t){return void 0!==t&&null!==t}function d(t){return t&&t.meta&&t.meta.params}function v(t,e){return f(e.meta.params[t])?Object.keys(e.meta.params[t]).reduce(function(t,n){return t[n]=e.params[n],t},{}):{}}function y(t,e){var n=e?p(e.name):[],r=p(t.name),o=Math.min(n.length,r.length),a=void 0;e?d(e)||d(t)?a=function(){var a=void 0;for(a=0;a<o;a+=1){var u=function(){var o=n[a],u=r[a];if(o!==u)return{v:a};var i=v(o,t),c=v(u,e);return i.length!==c.length?{v:a}:0===i.length?"continue":Object.keys(i).some(function(t){return c[t]!==i[t]})?{v:a}:void 0}();switch(u){case"continue":continue;default:if("object"===(void 0===u?"undefined":C(u)))return u.v}}return a}():(console.warn("[router5.transition-path] Some states are missing metadata, reloading all segments"),a=0):a=0;var u=n.slice(a).reverse(),i=r.slice(a);return{intersection:e&&a>0?n[a-1]:"",toDeactivate:u,toActivate:i}}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"router",n=function(t){return t[e]||t.get&&t.get(e)},r=void 0;return function(e){var o=n(e),a=o.route,u=o.previousRoute,i=a?y(a,u).intersection:"";return r?(!u||u!==a&&i===t)&&(r={route:a,previousRoute:u}):r={route:a,previousRoute:u},r}}var T="@@router5/NAVIGATE",m="@@router5/CANCEL",A="@@router5/TRANSITION_ERROR",E="@@router5/TRANSITION_SUCCESS",S="@@router5/TRANSITION_START",N="@@router5/CLEAR_ERRORS",g="@@router5/CAN_DEACTIVATE",I="@@router5/CAN_ACTIVATE",b=Object.freeze({NAVIGATE_TO:T,CANCEL_TRANSITION:m,TRANSITION_ERROR:A,TRANSITION_SUCCESS:E,TRANSITION_START:S,CLEAR_ERRORS:N,CAN_DEACTIVATE:g,CAN_ACTIVATE:I}),h=Object.freeze({navigateTo:e,cancelTransition:n,clearErrors:r,transitionStart:o,transitionSuccess:a,transitionError:u,canActivate:i,canDeactivate:c}),O=function(t){return function(e){var n=e.dispatch;return t.setDependency("store",e),t.usePlugin(s(n)),function(e){return function(n){switch(n.type){case T:var r=n.payload,o=r.name,a=r.params,u=r.opts;t.navigate(o,a,u);break;case m:t.cancel();break;case g:t.canDeactivate(n.payload.name,n.payload.canDeactivate);break;case I:t.canActivate(n.payload.name,n.payload.canDeactivate);break;default:return e(n)}}}}},C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D={route:null,previousRoute:null,transitionRoute:null,transitionError:null};t.router5Middleware=O,t.router5Reducer=l,t.actions=h,t.actionTypes=b,t.routeNodeSelector=R,t.reduxPlugin=s,Object.defineProperty(t,"__esModule",{value:!0})});
