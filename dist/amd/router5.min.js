"use strict";define("router5",[],function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e,n,r,a){var i=arguments.length<=5||void 0===arguments[5]?!1:arguments[5];t=t||function(){return!1};var u=e||[],s=function(t){if(!u.length)return!0;var e=u[0].length,a=u[0](n,r,t);return"boolean"==typeof a?t(a?null:!0):a&&"function"==typeof a.then?a.then(function(){return t(null)},function(){return t(!0)}):3>e&&i&&t(null),!1},o=function(t){t?a(t):(u=u.slice(1),l())},l=function(){if(t())a(null);else{var e=s(o);e&&a(null)}};l()}function n(t,e){var n=function(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])},r=void 0,a=e?n(e.name):[],i=n(t.name),u=Math.min(a.length,i.length);if(e&&e.name===t.name)r=Math.max(u-1,0);else for(r=0;u>r&&a[r]===i[r];r+=1);var s=a.slice(r).reverse(),o=i.slice(r),l=e&&r>0?a[r-1]:"";return{intersection:l,toDeactivate:s,toActivate:o}}function r(t,r,a,i){var u=!1,s=function(){return u},o=function(){return u=!0},l=function(t){return i(u?S.TRANSITION_CANCELLED:t)},h=n(r,a),c=h.toDeactivate,f=h.toActivate,m=function(n,r,a){var i=c.map(function(e){return t._cmps[e]}).filter(function(t){return t&&t.canDeactivate}).map(function(t){return t.canDeactivate});e(s,i,n,r,function(t){return a(t?S.CANNOT_DEACTIVATE:null)})},p=function(n,r,a){var i=f.map(function(e){return t._canAct[e]}).filter(function(t){return t});e(s,i,n,r,function(t){return a(t?S.CANNOT_ACTIVATE:null)})},d=t._onTr,g=function(t,n,r){var a=[d];e(s,a,t,n,function(t){return r(t?S.TRANSITION_ERR:null)})},v=(a?[m]:[]).concat(p).concat(d?g:[]);return e(s,v,r,a,l),o}function a(t,e){var n=function(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])},r=void 0,a=e?n(e.name):[],i=n(t.name),u=Math.min(a.length,i.length);if(e&&e.name===t.name)r=Math.max(u-1,0);else for(r=0;u>r&&a[r]===i[r];r+=1);return e&&r>0?a[r-1]:""}function i(){function t(t){var e=function(e,n){return i[e]&&(i[e]=i[e].filter(function(t){return t!==n})),t},n=function(e,n,r){var a=e.replace(/^(\*|\^|=)/,"");if(a&&!/^\$/.test(e)){var u=t.rootNode.getSegmentsByName(a);u||console.warn("No route found for "+a+", listener might never be called!")}return i[e]||(i[e]=[]),i[e]=(r?[]:i[e]).concat(n),t};t.addListener=function(t){return n("*",t)},t.removeListener=function(t){return e("*",t)},t.addNodeListener=function(t,e){return n("^"+t,e,!0)},t.removeNodeListener=function(t,n){return e("^"+t,n)},t.addRouteListener=function(t,e){return n("="+t,e)},t.removeRouteListener=function(t,n){return e("="+t,n)}}function e(t,e,n){(i[t]||[]).forEach(function(t){return t(e,n)})}function n(t,n){var r=a(t,n),i=t.name;e("^"+r,t,n),e("="+i,t,n),e("*",t,n)}function r(){i={}}var i={};return{name:D,init:t,onTransitionSuccess:n,flush:r}}var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t){return"("+(t?t.replace(/(^<|>$)/g,""):"[a-zA-Z0-9-_.~]+")+")"},o=[{name:"url-parameter",pattern:/^:([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(s(t[2]))}},{name:"url-parameter-splat",pattern:/^\*([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/,regex:/([^\?]*)/},{name:"url-parameter-matrix",pattern:/^\;([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(";"+t[1]+"="+s(t[2]))}},{name:"query-parameter",pattern:/^(?:\?|&)(?:\:)?([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/},{name:"delimiter",pattern:/^(\/|\?)/,regex:function(t){return new RegExp("\\"+t[0])}},{name:"sub-delimiter",pattern:/^(\!|\&|\-|_|\.|;)/,regex:function(t){return new RegExp(t[0])}},{name:"fragment",pattern:/^([0-9a-zA-Z]+?)/,regex:function(t){return new RegExp(t[0])}}],l=function j(t){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],n=o.some(function(n){var r=t.match(n.pattern);return r?(e.push({type:n.name,match:r[0],val:r.slice(1,2),otherVal:r.slice(2),regex:n.regex instanceof Function?n.regex(r):n.regex}),r[0].length<t.length&&(e=j(t.substr(r[0].length),e)),!0):!1});if(!n)throw new Error("Could not parse path.");return e},h=function(t,e){return e?t.replace(/\\\/$/,"")+"(?:\\/)?":t},c=function(t,e){var n=arguments.length<=2||void 0===arguments[2]?"":arguments[2],r=t[e];return void 0===r?t[e]=n:t[e]=Array.isArray(r)?r.concat(n):[r,n],t},f=function(t){var e=t.split("?")[1];return e?e.split("&").map(function(t){return t.split("=")}).reduce(function(t,e){return c(t,e[0],e[1])},{}):{}},m=function(t){return void 0!==t&&null!==t&&""!==t?"="+t:""},p=function U(t,e){return Array.isArray(e)?e.map(function(e){return U(t,e)}).join("&"):t+m(e)},d=function(){function e(n){if(t(this,e),!n)throw new Error("Please supply a path");this.path=n,this.tokens=l(n),this.hasUrlParams=this.tokens.filter(function(t){return/^url-parameter/.test(t.type)}).length>0,this.hasSpatParam=this.tokens.filter(function(t){return/splat$/.test(t.type)}).length>0,this.hasMatrixParams=this.tokens.filter(function(t){return/matrix$/.test(t.type)}).length>0,this.hasQueryParams=this.tokens.filter(function(t){return"query-parameter"===t.type}).length>0,this.urlParams=this.hasUrlParams?this.tokens.filter(function(t){return/^url-parameter/.test(t.type)}).map(function(t){return t.val.slice(0,1)}).reduce(function(t,e){return t.concat(e)}):[],this.queryParams=this.hasQueryParams?this.tokens.filter(function(t){return"query-parameter"===t.type}).map(function(t){return t.val}).reduce(function(t,e){return t.concat(e)}):[],this.params=this.urlParams.concat(this.queryParams),this.source=this.tokens.filter(function(t){return void 0!==t.regex}).map(function(t){return t.regex.source}).join("")}return u(e,null,[{key:"createPath",value:function(t){return new e(t)}},{key:"serialise",value:function(t,e){return p(t,e)}}]),u(e,[{key:"_urlMatch",value:function(t,e){var n=this,r=t.match(e);return r?this.urlParams.length?r.slice(1,this.urlParams.length+1).reduce(function(t,e,r){return t[n.urlParams[r]]=e,t},{}):{}:null}},{key:"match",value:function n(t){var e=this,r=arguments.length<=1||void 0===arguments[1]?0:arguments[1],a=h(this.source,r),n=this._urlMatch(t,new RegExp("^"+a+(this.hasQueryParams?"\\?.*$":"$")));if(!n||!this.hasQueryParams)return n;var i=f(t),u=Object.keys(i).filter(function(t){return-1===e.queryParams.indexOf(t)});return 0===u.length?(Object.keys(i).forEach(function(t){return n[t]=i[t]}),n):null}},{key:"partialMatch",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=h(this.source,n),a=this._urlMatch(t,new RegExp("^"+r));if(!a)return a;if(!this.hasQueryParams)return a;var i=f(t);return Object.keys(i).filter(function(t){return e.queryParams.indexOf(t)>=0}).forEach(function(t){return c(a,t,i[t])}),a}},{key:"build",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments.length<=1||void 0===arguments[1]?{ignoreConstraints:!1,ignoreSearch:!1}:arguments[1];if(this.urlParams.some(function(e){return void 0===t[e]}))throw new Error("Missing parameters");if(!e.ignoreConstraints){var n=this.tokens.filter(function(t){return/^url-parameter/.test(t.type)&&!/-splat$/.test(t.type)}).every(function(e){return new RegExp("^"+s(e.otherVal[0])+"$").test(t[e.val])});if(!n)throw new Error("Some parameters are of invalid format")}var r=this.tokens.filter(function(t){return"query-parameter"!==t.type}).map(function(e){return"url-parameter-matrix"===e.type?";"+e.val[0]+"="+t[e.val[0]]:/^url-parameter/.test(e.type)?t[e.val[0]]:e.match}).join("");if(e.ignoreSearch)return r;var a=this.queryParams.filter(function(e){return-1!==Object.keys(t).indexOf(e)}).map(function(e){return p(e,t[e])}).join("&");return r+(a?"?"+a:"")}}]),e}(),g=function(t){return void 0!==t&&null!==t&&""!==t},v=function(t,e){if(-1===t.indexOf("?"))return t;var n=t.split("?"),r=n[0],a=n[1],i=a.split("&").reduce(function(t,n){var r=n.split("="),a=r[0],i=r[1];return-1===e.indexOf(a)&&(t[a]=i||""),t},{}),u=Object.keys(i).map(function(t){return[t].concat(g(i[t])?i[t]:[])}).map(function(t){return t.join("=")}).join("&");return r+(u?"?"+u:"")},y=function(){function e(){var n=arguments.length<=0||void 0===arguments[0]?"":arguments[0],r=arguments.length<=1||void 0===arguments[1]?"":arguments[1],a=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];return t(this,e),this.name=n,this.path=r,this.parser=r?new d(r):null,this.children=[],this.add(a),this}return u(e,[{key:"add",value:function(t){var n=this;if(void 0!==t&&null!==t){if(t instanceof Array)return void t.forEach(function(t){return n.add(t)});if(!(t instanceof e||t instanceof Object))throw new Error("RouteNode.add() expects routes to be an Object or an instance of RouteNode.");if(t instanceof Object){if(!t.name||!t.path)throw new Error("RouteNode.add() expects routes to have a name and a path defined.");t=new e(t.name,t.path,t.children)}if(-1!==this.children.map(function(t){return t.name}).indexOf(t.name))throw new Error('Alias "'+t.name+'" is already defined in route node');if(-1!==this.children.map(function(t){return t.path}).indexOf(t.path))throw new Error('Path "'+t.path+'" is already defined in route node');var r=t.name.split(".");if(1===r.length)this.children.push(t),this.children.sort(function(t,e){if("/"===t.path)return 1;if("/"===e.path)return-1;var n=t.parser.hasUrlParams||t.parser.hasSpatParam,r=e.parser.hasUrlParams||e.parser.hasSpatParam;if(!n&&!r)return t.path&&e.path?t.path.length<e.path.length?1:-1:0;if(n&&!r)return 1;if(!n&&r)return-1;if(!t.parser.hasSpatParam&&e.parser.hasSpatParam)return-1;if(!e.parser.hasSpatParam&&t.parser.hasSpatParam)return 1;var a=(t.path.match(/\//g)||[]).length,i=(e.path.match(/\//g)||[]).length;return i>a?1:0});else{var a=this.getSegmentsByName(r.slice(0,-1).join("."));if(!a)throw new Error("Could not add route named '"+t.name+"', parent is missing.");a[a.length-1].add(new e(r[r.length-1],t.path,t.children))}return this}}},{key:"addNode",value:function(t,n){return this.add(new e(t,n)),this}},{key:"getSegmentsByName",value:function(t){var e=function(t,e){var n=e.filter(function(e){return e.name===t});return n.length?n[0]:void 0},n=[],r=t.split("."),a=this.children,i=r.every(function(t){var r=e(t,a);return r?(a=r.children,n.push(r),!0):!1});return i?n:null}},{key:"getSegmentsMatchingPath",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=function i(t,n,r){var a=function(a){var u=t[a],s=u.parser.partialMatch(n),o=void 0;if(!s&&e)s=u.parser.match(n,!0),o="";else if(s){var l=u.parser.build(s,{ignoreSearch:!0});o=v(n.replace(l,""),u.parser.queryParams),e&&"/"===o&&!/\/$/.test(l)&&(o="")}return s?(r.push(u),Object.keys(s).forEach(function(t){return r.params[t]=s[t]}),o.length?u.children.length?{v:i(u.children,o,r)}:{v:null}:{v:r}):void 0};for(var u in t){var s=a(u);if("object"==typeof s)return s.v}return null},r=this.parser?[this]:this.children,a=[];return a.params={},n(r,t,a)}},{key:"getPathFromSegments",value:function(t){return t?t.map(function(t){return t.path}).join(""):null}},{key:"getPath",value:function(t){return this.getPathFromSegments(this.getSegmentsByName(t))}},{key:"buildPathFromSegments",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!t)return null;var n=t.filter(function(t){return t.parser.hasQueryParams}).map(function(t){return t.parser.queryParams}),r=n.length?n.reduce(function(t,e){return t.concat(e)}).filter(function(t){return-1!==Object.keys(e).indexOf(t)}).map(function(t){return d.serialise(t,e[t])}).join("&"):null;return t.map(function(t){return t.parser.build(e,{ignoreSearch:!0})}).join("")+(r?"?"+r:"")}},{key:"buildPath",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.buildPathFromSegments(this.getSegmentsByName(t),e)}},{key:"getMatchPathFromSegments",value:function(t){if(!t||!t.length)return null;var e=t.map(function(t){return t.name}).join("."),n=t.params;return{name:e,params:n}}},{key:"matchPath",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return this.getMatchPathFromSegments(this.getSegmentsMatchingPath(t,e))}}]),e}(),S={ROUTER_NOT_STARTED:"NOT_STARTED",ROUTER_ALREADY_STARTED:"ALREADY_STARTED",ROUTE_NOT_FOUND:"ROUTE_NOT_FOUND",SAME_STATES:"SAME_STATES",CANNOT_DEACTIVATE:"CANNOT_DEACTIVATE",CANNOT_ACTIVATE:"CANNOT_ACTIVATE",TRANSITION_ERR:"TRANSITION_ERR",NODE_LISTENER_ERR:"NODE_ERR",TRANSITION_CANCELLED:"CANCELLED"},E=function(t){return function(){return t}},w=function(){},_="undefined"!=typeof window,A=function(){return window.location.pathname.replace(/\/$/,"")},T=function(t,e,n){return window.history.pushState(t,e,n)},P=function(t,e,n){return window.history.replaceState(t,e,n)},k=function(t){return window.addEventListener("popstate",t)},N=function(t){return window.removeEventListener("popstate",t)},R=function(t){var e=t.useHash?window.location.hash.replace(new RegExp("^#"+t.hashPrefix),""):window.location.pathname.replace(new RegExp("^"+t.base),"");return e+window.location.search},O=function(){return window.history.state},b={};b=_?{getBase:A,pushState:T,replaceState:P,addPopstateListener:k,removePopstateListener:N,getLocation:R,getState:O}:{getBase:E(""),pushState:w,replaceState:w,addPopstateListener:w,removePopstateListener:w,getLocation:E(""),getState:E(null)};var x=function(){function t(t,e){var n=[],r=!0,a=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(o){a=!0,i=o}finally{try{!r&&s["return"]&&s["return"]()}finally{if(a)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),L=function(t,e,n){return{name:t,params:e,path:n}},C=function(){function e(n){var r=this,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t(this,e),this.started=!1,this._onTr=null,this._cbs={},this._cmps={},this._canAct={},this.lastStateAttempt=null,this.lastKnownState=null,this.rootNode=n instanceof y?n:new y("","",n),this.options={useHash:!1,hashPrefix:"",base:"",trailingSlash:0},Object.keys(a).forEach(function(t){return r.options[t]=a[t]}),this._setBase(),this.registeredPlugins={},this.boundOnPopState=this.onPopState.bind(this)}return u(e,[{key:"_setBase",value:function(){this.options.useHash&&!this.options.base&&(this.options.base=b.getBase())}},{key:"setOption",value:function(t,e){return this.options[t]=e,"useHash"===t&&this._setBase(),this}},{key:"add",value:function(t){return this.rootNode.add(t),this}},{key:"addNode",value:function(t,e,n){return this.rootNode.addNode(t,e),n&&(this._canAct[t]=n),this}},{key:"usePlugin",value:function(t){var e=this;t.name||console.warn("[router5.registerPlugin(plugin)] Missing property pluginName");var n=["onStart","onStop","onTransitionStart","onTransitionSuccess","onTransitionStart","onTransitionError","onTransitionCancel"],r=n.concat("init").some(function(e){return void 0!==t[e]});if(!r)throw new Error("[router5] plugin "+t.name+" has none of the expected methods implemented");return this.registeredPlugins[t.name]=t,t.init&&t.init(this),n.forEach(function(n){t[n]&&e._addListener(n.toLowerCase().replace(/^on/,"$"),t[n])}),this}},{key:"onPopState",value:function(t){var e=this,n=!t.state||!t.state.name,r=t.state||this.matchPath(this.getLocation()),a=this.options;return r?void(this.lastKnownState&&this.areStatesEqual(r,this.lastKnownState)||this._transition(r,this.lastKnownState,function(t,i){if(t)if(t===S.CANNOT_DEACTIVATE){var u=e.buildUrl(e.lastKnownState.name,e.lastKnownState.params);n||e.updateBrowserState(r,u,!0)}else e.navigate(a.defaultRoute,a.defaultParams,{reload:!0,replace:!0});else e.updateBrowserState(i,e.buildUrl(i.name,i.params),n)})):void this.navigate(a.defaultRoute,a.defaultParams,{reload:!0,replace:!0})}},{key:"onTransition",value:function(t){return this._onTr=t,this}},{key:"start",value:function(){var t=this,e=Array.prototype.slice.call(arguments),n=e.slice(-1)[0],r=n instanceof Function?n:null,a=void 0,i=void 0;if(this.started)return r&&r(S.ROUTER_ALREADY_STARTED),this;e.length>0&&("string"==typeof e[0]&&(a=e[0]),"object"==typeof e[0]&&(i=e[0])),this.started=!0,this._invokeListeners("$start");var u=this.options,s=function(e,n){var a=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];b.addPopstateListener(t.boundOnPopState),r&&r(e,n),e&&a&&t._invokeListeners("$transitionerror",n,null,e)};return a||i||(a=this.getLocation()),i?(this.lastKnownState=i,this.updateBrowserState(this.lastKnownState,this.buildUrl(i.name,i.params),!0),s(null,i)):!function(){i=t.matchPath(a);var e=function(){return t.navigate(u.defaultRoute,u.defaultParams,{replace:!0},function(t,e){return s(t,e,!1)})};i?(t.lastStateAttempt=i,t._transition(t.lastStateAttempt,t.lastKnownState,function(n,r){n?u.defaultRoute?e():s(n,null,!1):(t.updateBrowserState(t.lastKnownState,t.buildUrl(i.name,i.params),!0),s(null,r))})):u.defaultRoute?e():s(S.ROUTE_NOT_FOUND,null)}(),this}},{key:"stop",value:function(){return this.started?(this.lastKnownState=null,this.lastStateAttempt=null,this.started=!1,this._invokeListeners("$stop"),b.removePopstateListener(this.boundOnPopState),this):this}},{key:"getState",value:function(){return this.lastKnownState}},{key:"isActive",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],a=this.getState();return a?n||a.name===t?this.areStatesEqual(L(t,e),a,r):this.areStatesDescendants(L(t,e),a):!1}},{key:"areStatesEqual",value:function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];if(t.name!==e.name)return!1;var a=function(t){return n.rootNode.getSegmentsByName(t).map(function(t){return t.parser[r?"urlParams":"params"]}).reduce(function(t,e){return t.concat(e)},[])},i=a(t.name),u=a(e.name);return i.length===u.length&&i.every(function(n){return t.params[n]===e.params[n]})}},{key:"areStatesDescendants",value:function(t,e){var n=new RegExp("^"+t.name+"\\.(.*)$");return n.test(e.name)?Object.keys(t.params).every(function(n){return t.params[n]===e.params[n]}):!1}},{key:"_invokeListeners",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];(this._cbs[t]||[]).forEach(function(t){return t.apply(void 0,n)})}},{key:"_addListener",value:function(t,e,n){return this._cbs[t]=(this._cbs[t]||[]).concat(e),this}},{key:"registerComponent",value:function(t,e){return this._cmps[t]&&console.warn("A component was alread registered for route node "+t+"."),this._cmps[t]=e,this}},{key:"deregisterComponent",value:function(t){delete this._cmps[t]}},{key:"canActivate",value:function(t,e){return this._canAct[t]=e,this}},{key:"getLocation",value:function(){return b.getLocation(this.options)}},{key:"buildUrl",value:function(t,e){return this._buildUrl(this.rootNode.buildPath(t,e))}},{key:"_buildUrl",value:function(t){return this.options.base+(this.options.useHash?"#"+this.options.hashPrefix:"")+t}},{key:"buildPath",value:function(t,e){return this.rootNode.buildPath(t,e)}},{key:"matchPath",value:function(t){var e=this.rootNode.matchPath(t,this.options.trailingSlash);return e?L(e.name,e.params,t):null}},{key:"urlToPath",value:function(t){var e=t.match(/^(?:http|https)\:\/\/(?:[0-9a-z_\-\.\:]+?)(?=\/)(.*)$/),n=e?e[1]:t,r=n.match(/^(.*?)(#.*?)?(\?.*)?$/);if(!r)throw new Error("[router5] Could not parse url "+t);var a=r.slice(1),i=x(a,3),u=i[0],s=i[1],o=i[2],l=this.options;return(l.useHash?s.replace(new RegExp("^#"+l.hashPrefix),""):u.replace(new RegExp("^"+l.base),""))+(o||"")}},{key:"matchUrl",value:function(t){return this.matchPath(this.urlToPath(t))}},{key:"_transition",value:function(t,e,n){var a=this;this._tr&&this._tr(),this._invokeListeners("$transitionstart",t,e);var i=r(this,t,e,function(r){return a._tr=null,r?(r===S.TRANSITION_CANCELLED?a._invokeListeners("$transitioncancel",t,e):a._invokeListeners("$transitionerror",t,e,r),void(n&&n(r))):(a.lastKnownState=t,a._invokeListeners("$transitionsuccess",t,e),void(n&&n(null,t)))});return this._tr=i,function(){return!i||i()}}},{key:"navigate",value:function(t,e,n,r){void 0===e&&(e={});var a=this;if(void 0===n&&(n={}),!this.started)return void(r&&r(S.ROUTER_NOT_STARTED));b.getState()||(n.replace=!0);var i=this.buildPath(t,e),u=this.buildUrl(t,e);if(!i)return r&&r(S.ROUTE_NOT_FOUND),void this._invokeListeners("$transitionerror",null,this.lastKnownState,S.ROUTE_NOT_FOUND);var s=L(t,e,i);this.lastStateAttempt=s;var o=this.lastKnownState?this.areStatesEqual(this.lastKnownState,this.lastStateAttempt):!1;return o&&!n.reload?(r&&r(S.SAME_STATES),void this._invokeListeners("$transitionerror",s,this.lastKnownState,S.SAME_STATES)):this._transition(s,o?null:this.lastKnownState,function(t,e){return t?void(r&&r(t)):(a.updateBrowserState(a.lastStateAttempt,u,n.replace),void(r&&r(null,e)))})}},{key:"updateBrowserState",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=arguments.length<=3||void 0===arguments[3]?"":arguments[3];b[n?"replaceState":"pushState"](t,r,e)}}]),e}();C.ERR=S,C.transitionPath=n;var D="LISTENERS";return{RouteNode:y,Router5:C,listenersPlugin:i}});