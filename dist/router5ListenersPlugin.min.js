!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.router5ListenersPlugin=e()}(this,function(){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)};function t(n){return n.split(".").reduce(function(n,e){return n.concat(n.length?n[n.length-1]+"."+e:e)},[])}function o(n){return n&&n.meta&&n.meta.params}function r(n,e){return void 0===(t=e.meta.params[n])||null===t?{}:Object.keys(e.meta.params[n]).reduce(function(n,t){return n[t]=e.params[t],n},{});var t}var i={autoCleanUp:!0};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;function u(i){var u={};function c(n,e){return e?u[n]&&(u[n]=u[n].filter(function(n){return n!==e})):u[n]=[],i}function a(n,e,t){var o=n.replace(/^(\*|\^|=)/,"");return o&&!/^\$/.test(n)&&(i.rootNode.getSegmentsByName(o)||console.warn("No route found for "+o+", listener might never be called!")),u[n]||(u[n]=[]),u[n]=(t?[]:u[n]).concat(e),i}function f(n,e,t){(u[n]||[]).forEach(function(o){-1!==u[n].indexOf(o)&&o(e,t)})}return i.getListeners=function(){return u},i.addListener=function(n){return a("*",n)},i.removeListener=function(n){return c("*",n)},i.addNodeListener=function(n,e){return a("^"+n,e,!0)},i.removeNodeListener=function(n,e){return c("^"+n,e)},i.addRouteListener=function(n,e){return a("="+n,e)},i.removeRouteListener=function(n,e){return c("="+n,e)},{onTransitionSuccess:function(i,u,a){var s=function(n,i){var u=i?t(i.name):[],c=t(n.name),a=Math.min(u.length,c.length),f=void 0;i?o(i)||o(n)?f=function(){var t=void 0,o=function(){var e=u[t],o=c[t];if(e!==o)return{v:t};var a=r(e,n),f=r(o,i);return a.length!==f.length?{v:t}:0===a.length?"continue":Object.keys(a).some(function(n){return f[n]!==a[n]})?{v:t}:void 0};for(t=0;t<a;t+=1){var f=o();switch(f){case"continue":continue;default:if("object"===(void 0===f?"undefined":e(f)))return f.v}}return t}():(console.warn("[router5-transition-path] Some states are missing metadata, reloading all segments"),f=0):f=0;var s=u.slice(f).reverse(),l=c.slice(f);return{intersection:i&&f>0?u[f-1]:"",toDeactivate:s,toActivate:l}}(i,u),l=s.intersection,m=s.toDeactivate,d=a.reload?"":l,v=i.name;n.autoCleanUp&&m.forEach(function(n){return c("^"+n)}),f("^"+d,i,u),f("="+v,i,u),f("*",i,u)}}}return u.pluginName="LISTENERS_PLUGIN",u}});
