!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.router5ListenersPlugin=e()}(this,function(){"use strict";function n(n){return n.split(".").reduce(function(n,e){return n.concat(n.length?n[n.length-1]+"."+e:e)},[])}function e(n){return void 0!==n&&null!==n}function t(n){return n&&n.meta&&n.meta.params}function o(n,t){return e(t.meta.params[n])?Object.keys(t.meta.params[n]).reduce(function(n,e){return n[e]=t.params[e],n},{}):{}}function r(e,r){var i=r?n(r.name):[],u=n(e.name),a=Math.min(i.length,u.length),f=void 0;r?t(r)||t(e)?f=function(){var n=void 0;for(n=0;n<a;n+=1){var t=function(){var t=i[n],c=u[n];if(t!==c)return{v:n};var a=o(t,e),f=o(c,r);return a.length!==f.length?{v:n}:0===a.length?"continue":Object.keys(a).some(function(n){return f[n]!==a[n]})?{v:n}:void 0}();switch(t){case"continue":continue;default:if("object"===(void 0===t?"undefined":c(t)))return t.v}}return n}():(console.warn("[router5-transition-path] Some states are missing metadata, reloading all segments"),f=0):f=0;var s=i.slice(f).reverse(),l=u.slice(f);return{intersection:r&&f>0?i[f-1]:"",toDeactivate:s,toActivate:l}}function i(){function n(n){function t(e,t){return t?c[e]&&(c[e]=c[e].filter(function(n){return n!==t})):c[e]=[],n}function o(e,t,o){var r=e.replace(/^(\*|\^|=)/,"");if(r&&!/^\$/.test(e)){n.rootNode.getSegmentsByName(r)||console.warn("No route found for "+r+", listener might never be called!")}return c[e]||(c[e]=[]),c[e]=(o?[]:c[e]).concat(t),n}function i(n,e,t){(c[n]||[]).forEach(function(o){-1!==c[n].indexOf(o)&&o(e,t)})}function u(n,o,u){var c=r(n,o),a=c.intersection,f=c.toDeactivate,s=u.reload?"":a,l=n.name;e.autoCleanUp&&f.forEach(function(n){return t("^"+n)}),i("^"+s,n,o),i("="+l,n,o),i("*",n,o)}var c={};return n.getListeners=function(){return c},n.addListener=function(n){return o("*",n)},n.removeListener=function(n){return t("*",n)},n.addNodeListener=function(n,e){return o("^"+n,e,!0)},n.removeNodeListener=function(n,e){return t("^"+n,e)},n.addRouteListener=function(n,e){return o("="+n,e)},n.removeRouteListener=function(n,e){return t("="+n,e)},{onTransitionSuccess:u}}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return n.pluginName="LISTENERS_PLUGIN",n}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c="function"==typeof Symbol&&"symbol"===u(Symbol.iterator)?function(n){return void 0===n?"undefined":u(n)}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":void 0===n?"undefined":u(n)},a={autoCleanUp:!0};return i});
